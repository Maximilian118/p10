@use '../../../../../../scss/variables';
@use '../../../../../../scss/mixins';

.f1-session-view {
  width: 100%;
  @include mixins.flexbox-start-column;
  flex-grow: 1;
  box-sizing: border-box;
  overflow: hidden;
  position: relative;

  .fill-loading {
    margin-bottom: 70px;
  }

  // Wrapper for main content — must participate in the flex chain so
  // .driver-list can grow and scroll within the remaining space.
  .f1-session-content {
    @include mixins.flexbox-start-column;
    width: 100%;
    flex-grow: 1;
    min-height: 0;

    .f1-session-weather-bar {
      width: 100%;
      @include mixins.flexbox;
      padding: 2px 20px;
      box-sizing: border-box;
      background: white;
      gap: 8px;

      .f1-session-guages {
        height: 100%;
        padding: 4px 0 2px;
        box-sizing: border-box;
        @include mixins.flexbox;
        gap: 8px;
      }

      .f1-session-icon-container {
        width: 27px;
        height: 27px;
        @include mixins.flexbox;

        svg { 
          width: 24px; 
          height: 24px; 
        }

        // Lucide icons use stroke="currentColor", so CSS color is all we need.
        &.rain { color: #3b82f6; }
        &.sun { color: #f59e0b; }
      }
    }

    // Top bar with centered title and optional SC/MC pill on the left.
    // 3-column grid keeps the title dead center regardless of pill presence.
    .f1-session-bar-top {
      width: 100%;
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      padding: 0 20px;
      box-sizing: border-box;
      margin-top: 20px;

      // Outlined pill indicating Safety Car or Medical Car deployment.
      .safety-vehicle-pill {
        grid-column: 1;
        justify-self: start;
        font-family: 'formula1-regular', sans-serif;
        font-size: 11px;
        padding: 2px 10px;
        border-radius: 4px;
        border: 2px solid;

        // Safety Car — yellow/orange outline.
        &--sc {
          color: variables.$rarity-mythic;
          border-color: variables.$rarity-mythic;
        }

        // Medical Car — blue outline.
        &--mc {
          color: variables.$mui-blue;
          border-color: variables.$mui-blue;
        }
      }

      .f1-session-title {
        grid-column: 2;
        font-size: 14px;

        // Red text when the demo replay has ended.
        &--ended {
          color: #f44336;
        }
      }
    }
  }

  // Track map container fills the main content area.
  .trackmap-container {
    width: 100%;
    height: 240px;
    flex-shrink: 0;
    position: relative;

    .trackmap-bar-bottom {
      width: 100%;
      height: 40px;
      @include mixins.flexbox-space-between;
      position: absolute;
      padding: 0 5px;
      box-sizing: border-box;
      bottom: 0;

      // Race control toggle button (bottom-left of trackmap).
      .rc-toggle {
        width: 28px;
        height: 28px;
        @include mixins.flexbox;
        border-radius: 4px;
        cursor: pointer;
        color: variables.$colour-3;
        transition: all variables.$trans-speed;

        &:hover { color: variables.$colour-9; }

        &--active {
          color: variables.$colour-9;
          background: variables.$colour-1;
        }
      }

      // Loop icon (admin rotation handle) pushed to the right.
      > svg {
        margin-left: auto;
        cursor: grab;

        &:active {
          cursor: grabbing;
        }
      }
    }
  }

  .driver-list {
    @include mixins.flexbox-start-column;
    width: 100%;
    flex-grow: 1;
    min-height: 0;
    overflow-y: auto;
  }

  // Scrollable race control messages panel — replaces driver-list when toggled.
  // Same flex layout as .driver-list so it fills the same space.
  .race-control-messages {
    @include mixins.flexbox-start-column;
    width: 100%;
    flex-grow: 1;
    min-height: 0;
    overflow-y: auto;
    background: variables.$colour-9;
    align-items: stretch;

    .rc-message {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);

      // Timestamp column.
      &__time {
        font-size: 11px;
        color: variables.$colour-3;
        white-space: nowrap;
        font-family: 'formula1-regular', sans-serif;
      }

      // Coloured dot indicating the flag type.
      &__flag {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        flex-shrink: 0;

        &--green { background: #4caf50; }
        &--yellow { background: #fdd835; }
        &--red { background: #f44336; }
        &--blue { background: #2196f3; }
        &--clear { background: #4caf50; }
        &--chequered { background: #ffffff; }
      }

      // Message text.
      &__text {
        font-size: 12px;
        color: #ffffff;
      }
    }
  }

  .advance-button {
    margin-top: 41px;
  }
}
